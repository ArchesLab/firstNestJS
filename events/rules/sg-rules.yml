#To test run:
# cd events
#npx sg scan -r "C:\Users\mary\Clubs\Research\simple-app\events\sg-rules.yml" "C:\Users\mary\Clubs\Research\simple-app\events\src\app.controller.ts" 
id: method-decorator-must-be-from-nestjs-common
language: ts
severity: info
message: NestJS method decorators should be imported from '@nestjs/common'.
rule:
  kind: identifier
  pattern: $METHOD
  all:
    - inside:
        kind: call_expression
        inside:
          kind: decorator
        stopBy: end
    -  inside:
        kind: program
        stopBy: end
        has:
          kind: import_statement
          has:
            kind: import_specifier
            stopBy: end
            has:
              kind: identifier
              pattern: $METHOD
            inside:
              kind: import_statement
              stopBy: end
              has:
                kind: string
                regex: "@nestjs/common"

constraints:
  METHOD:
    regex: "^(Get|Post|Put|Patch|Options|Delete|Head|All)$"
